(()=>{"use strict";document.querySelector(".popup__form");var e=document.forms["edit-profile"],t=document.forms["new-place"],n=(e.querySelector(".popup__button"),t.querySelector(".popup__button")),r=document.querySelector(".popup_type_image"),o=document.querySelector(".profile__edit-button"),c=document.querySelector(".profile__add-button"),a=document.querySelector(".popup__input_type_name"),i=document.querySelector(".popup__input_type_description"),u=document.querySelector(".user__name"),l=document.querySelector(".user__job"),s=Array.from(document.querySelectorAll(".popup")),p=document.querySelector(".popup_type_edit"),d=document.querySelector(".popup_type_new-card"),f=document.querySelector(".places__list"),m=document.querySelector(".popup__caption"),_=document.querySelector(".popup__image");function y(e){if("Escape"===e.key){var t=s.find((function(e){return e.classList.contains("popup_is-opened")}));t&&h(t)}}function v(e){e.target===e.currentTarget&&h(e.target)}function b(e){h(e.target.closest(".popup"))}function S(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",y)}function h(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",y)}var k="https://nomoreparties.co/v1/wff-cohort-7",g="cards",q={Authorization:"32e48890-9f28-47a5-845e-3c6381af43ab","Content-Type":"application/json"},C=function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))},E=function(){return fetch("".concat(k,"/").concat(g),{method:"GET",headers:q}).then(C)};function L(e,t){var n=t.deleteCardCallback,o=t.openImageCallback,c=t.likeCardCallback,a=document.querySelector("#card-template").content.querySelector(".places__item").cloneNode(!0),i=a.querySelector(".card__image"),u=a.querySelector(".card__title"),l=a.querySelector(".card__like-button");return i.src=e.link,i.alt=e.name,u.textContent=e.name,a.querySelector(".card__delete-button").addEventListener("click",(function(){n(a)})),i.addEventListener("click",(function(){o(i,_,m,r)})),l.addEventListener("click",(function(){c(l)})),a}var A=function(e,t){var n=e.querySelector("#".concat(t.id,"-error"));t.classList.remove("form__input_type_error"),n.classList.remove("form__input-error_active"),n.textContent=""},j=function(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.removeAttribute("disabled"),t.classList.remove("button_inactive")):t.classList.add("button_inactive")};function x(e,t){var n=t.inputSelector,r=t.submitButtonSelector,o=Array.from(e.querySelectorAll(n)),c=e.querySelector(r);o.forEach((function(t){A(e,t)})),j(o,c),c.setAttribute("disabled",!0)}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var T={deleteCardCallback:function(e){e.remove()},openImageCallback:function(e,n,r,o){n.src=e.src,n.alt=e.alt,r.textContent=e.alt,x(t,I),S(o)},likeCardCallback:function(e){e.classList.toggle("card__like-button_is-active")}},I={formSelector:".popup__form",inputSelector:".form__input",submitButtonSelector:".button",inactiveButtonClass:"button_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"};function O(e){e.preventDefault(),console.log(e.target),n.textContent="Сохранение...";var t=e.target.querySelector('.popup__input[name="place-name"]'),r=e.target.querySelector('.popup__input[name="link"]'),o=(null==t?void 0:t.value)||"",c=(null==r?void 0:r.value)||"",a=L(data={name:o,link:c},T);(function(e){return fetch("".concat(k,"/").concat(g),{method:"POST",headers:q,body:JSON.stringify({name:e.name,link:e.link})}).then(C)})(data={name:o,link:c}).then((function(){f.prepend(a),e.target.reset(),h(d)})).catch((function(e){console.log(e)})).finally((function(){n.textContent="Сохранить"}))}!function(e){e.inputSelector;var t=e.formElement;Array.from(document.querySelectorAll(t)).forEach((function(t){t.addEventListener("submit",(function(n){!function(e,t){var n=t.inputSelector,r=t.submitButtonSelector,o=Array.from(e.querySelectorAll(console.dir(n))),c=e.querySelector(r);j(o,c),o.forEach((function(t){t.addEventListener("input",(function(){!function(e,t){t.validity.valid?A(e,t):function(e,t,n){var r=e.querySelector("#".concat(t.id,"-error"));t.classList.add("form__input_type_error"),r.textContent=n,r.classList.add("form__input-error_active")}(e,t,t.validationMessage)}(e,t),j(o,c)}))}))}(t,e)}))}))}(I),o.addEventListener("click",(function(){var t;x(e,I),t&&(a.value=t.name,i.value=t.about),S(p)})),c.addEventListener("click",(function(){S(d)})),s.forEach((function(e){var t=e.querySelector(".popup__close");e.addEventListener("click",v),t.addEventListener("click",b)})),t.addEventListener("submit",O),d.addEventListener("submit",(function(e){return O(e)})),function(e,t){f.innerHTML="";for(var n=0;n<e.length;n++){var r=L(e[n],t);f.appendChild(r)}}([{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],T),Promise.all([fetch("".concat(k,"/").concat("users/me"),{method:"GET",headers:q}).then(C),E()]).then((function(e){var t,n,r,o=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,c,a,i=[],u=!0,l=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());o[0],r=o[1],u.textContent=r.name,l.textContent=r.about,avatarImage.setAttribute("style","background-image: url('".concat(r.avatar,"')")),E()})).catch((function(e){console.log(e)}))})();
//# sourceMappingURL=index.js.map